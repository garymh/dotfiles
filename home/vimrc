" ~/.vimrc
" thanks to the brilliant @tpope, @skwp, @nelstrom, @bling,
" @r00k, @spf13, @AndrewRadev, @junegunn, and @sjl for unknowingly
" allowing me to borrow from their dotfiles.

call plug#begin()
let s:darwin = has('mac')

" standard
Plug 'tpope/vim-sensible'
Plug 'tpope/vim-unimpaired'

" almost standard
Plug 'junegunn/fzf',             { 'dir': '~/.fzf', 'do': 'yes \| ./install' }
Plug 'junegunn/fzf.vim'
Plug 'junegunn/vim-oblique'
Plug 'mhinz/vim-sayonara'
Plug 'milkypostman/vim-togglelist'
Plug 'takac/vim-commandcaps'
Plug 'tpope/vim-commentary'
Plug 'tpope/vim-repeat'
Plug 'tpope/vim-sleuth'
Plug 'tpope/vim-surround'

" appearance
Plug 'Xuyuanp/nerdtree-git-plugin'
Plug 'Yggdroot/indentLine'
Plug 'junegunn/rainbow_parentheses.vim'
Plug 'junegunn/vim-peekaboo'
Plug 'nanotech/jellybeans.vim'
Plug 'vim-airline/vim-airline' | Plug 'vim-airline/vim-airline-themes'

" ruby
Plug 'janko-m/vim-test'
Plug 'ngmy/vim-rubocop',            { 'for': 'ruby' }
Plug 'tpope/vim-bundler',           { 'for': ['ruby', 'eruby', 'haml', 'slim'] }
Plug 'tpope/vim-rails',             { 'for': ['ruby', 'eruby', 'haml', 'slim'] }
Plug 'tpope/vim-rake',              { 'for': 'ruby' }

" syntax
Plug 'davejlong/cf-utils.vim',      { 'for': ['coldfusion', 'cfml'] }
Plug 'lilydjwg/colorizer',          { 'for': ['css', 'sass', 'scss', 'less', 'html', 'javascript'] }
Plug 'mattn/emmet-vim',             { 'for': ['eruby','html'] }
Plug 'sheerun/vim-polyglot'
Plug 'sunaku/vim-ruby-minitest'
Plug 'vim-scripts/applescript.vim'
Plug 'xolox/vim-lua-ftplugin',      { 'for': 'lua' }

" dependencies
Plug 'xolox/vim-misc'
Plug 'junegunn/vim-pseudocl'

" misc
Plug 'AndrewRadev/sideways.vim'
Plug 'AndrewRadev/splitjoin.vim'
Plug 'AndrewRadev/switch.vim'
Plug 'benekastah/neomake',          { 'on': ['Neomake'] }
Plug 'chip/vim-fat-finger'
Plug 'christoomey/vim-sort-motion'
Plug 'christoomey/vim-tmux-navigator'
Plug 'duff/vim-scratch'
Plug 'dyng/ctrlsf.vim',             { 'on': ['CtrlSF', 'CtrlSFToggle'] }
Plug 'junegunn/vim-easy-align',     { 'on': ['<Plug>(EasyAlign)', 'EasyAlign'] }
Plug 'scrooloose/nerdtree'
Plug 'sickill/vim-pasta'
Plug 't9md/vim-quickhl'
Plug 'terryma/vim-multiple-cursors'
Plug 'tpope/vim-abolish'
Plug 'tpope/vim-dispatch'
Plug 'tpope/vim-endwise'
Plug 'tpope/vim-eunuch'
Plug 'tpope/vim-fugitive'
Plug 'tpope/vim-projectionist'
Plug 'tpope/vim-rsi'
Plug 'vim-scripts/BufOnly.vim',     { 'on': 'Bonly' }
Plug 'wellle/visual-split.vim'

if s:darwin
  Plug 'rizzatti/dash.vim',         { 'on': ['Dash', '<Plug>DashSearch', '<Plug>DashGlobalSearch'] }
  Plug 'zerowidth/vim-copy-as-rtf', { 'on': 'CopyRTF' }

  if has('nvim')
    " completions are too much of a pain on Linux
    source ~/.vim/scripts/completions.vim
  else
    Plug 'jszakmeister/vim-togglecursor'
  endif
endif

" custom vim objects
Plug 'Julian/vim-textobj-brace'
Plug 'beloglazov/vim-textobj-quotes'
Plug 'coderifous/textobj-word-column.vim'
Plug 'glts/vim-textobj-indblock'
Plug 'kana/vim-textobj-entire'
Plug 'kana/vim-textobj-fold'
Plug 'kana/vim-textobj-indent'
Plug 'kana/vim-textobj-user'
Plug 'nelstrom/vim-textobj-rubyblock'

call plug#end()

set encoding=utf8

set cmdheight=2          " hopefully prevents the 'hit enter' prompts
set foldlevelstart=20
set formatprg="par 79"   " respect the 80 character lines
set gdefault             " assume the /g flag on :s substitutions
set guicursor=a:blinkon0 " stop blinking
set hidden               " make unsaved buffers hidden
set ignorecase
set modeline modelines=1 " check for syntax hints
set nocursorcolumn
set nocursorline
set nojoinspaces         " use only 1 space after '.' when joining lines
set noswapfile
" set nowrap               " don't wrap
set number
set scrolljump=5
set shiftround           " indenting to nearest tabstop
set shortmess=WatAIT     " no interruptive prompts
                         " http://items.sjbach.com/319/configuring-vim-right
set linebreak
set showmatch            " show matching brackets
set smartcase            " smartcase for searching
set splitbelow           " default split behavior
set splitright           " default split behavior
set synmaxcol=180
set ttimeoutlen=50       " vim-sensible's is kinda slow
set virtualedit=onemore  " allow selection past last character

set wildignore+=.DS_Store
set wildignore+=*.jpg,*.jpeg,*.gif,*.png,*.psd,*.o,*.obj,*.min.js,*.sock
set wildignore+=*/bower_components/*,*/node_modules/*
set wildignore+=*/smarty/*,*/vendor/*,*/.git/*,*/.hg/*,*/.svn/*,*/.sass-cache/*
set wildignore+=*/log/*,*/tmp/*,*/build/*,*/ckeditor/*,*/doc/*,*/source_maps/*
set wildignore+=*/dist/*,.keep,.starscope.db
set wildmode=list:longest

set softtabstop=2 tabstop=2 shiftwidth=2 expandtab

set fillchars=diff:⣿,vert:│

if !has('gui_macvim')
  set t_Co=256
endif
colorscheme jellybeans
let g:airline_theme = 'jellybeans'

if v:version > 703
  set colorcolumn=+1
  hi ColorColumn guibg=#363668 ctermbg=246
endif

" Persistent Undo {{{
silent !mkdir ~/.vim/backups > /dev/null 2>&1

if has("persistent_undo")
  set undodir=~/.vim/backups
  set undofile
endif
" }}}

source ~/.vim/scripts/autocommands.vim
source ~/.vim/scripts/mappings.vim
source ~/.vim/scripts/plugin_settings.vim

" Different cursor for insert mode in iTerm2, with tmux workaround.
" https://gist.github.com/1195581
" http://sourceforge.net/mailarchive/forum.php?thread_name=AANLkTinkbdoZ8eNR1X2UobLTeww1jFrvfJxTMfKSq-L%2B%40mail.gmail.com&forum_name=tmux-users

" For slow vim functions, from: http://til.hashrocket.com/posts/830c087a03-profiling-vim -
" To find which plugins may be causing certain actions in vim run slowly try using the built in profiler:

" :profile start profile.log
" :profile func *
" :profile file *
" Then perform the slow action, when done run:

" :profile pause
" :q
