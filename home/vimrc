" ~/.vimrc
" thanks to the brilliant @tpope, @skwp, @nelstrom, @bling,
" @r00k, @spf13, @AndrewRadev, @junegunn, and @sjl for unknowingly
" allowing me to borrow from their dotfiles.

call plug#begin()
  let s:darwin = has('mac')

  " standard
  Plug 'tpope/vim-sensible'
  Plug 'tpope/vim-unimpaired'

  " almost standard
  Plug 'junegunn/fzf',             { 'dir': '~/.fzf', 'do': 'yes \| ./install' }
  Plug 'junegunn/fzf.vim'
  Plug 'junegunn/vim-oblique'
  Plug 'mhinz/vim-sayonara'
  Plug 'milkypostman/vim-togglelist'
  Plug 'takac/vim-commandcaps'
  Plug 'tpope/vim-commentary'
  Plug 'tpope/vim-repeat'
  Plug 'tpope/vim-surround'

  " appearance
  Plug 'bling/vim-airline'
  Plug 'chriskempson/base16-vim'
  Plug 'chriskempson/vim-tomorrow-theme'
  Plug 'cocopon/iceberg.vim'
  Plug 'junegunn/vim-peekaboo'
  Plug 'nathanaelkane/vim-indent-guides'

  " ruby
  Plug 'janx/vim-rubytest'
  Plug 'ngmy/vim-rubocop',         { 'for': 'ruby' }
  Plug 'tpope/vim-bundler'
  Plug 'tpope/vim-rails'
  Plug 'tpope/vim-rake',           { 'for': 'ruby' }
  Plug 'tpope/vim-rbenv'

  " syntax
  Plug 'davejlong/cf-utils.vim',   { 'for': ['coldfusion', 'cfml'] }
  Plug 'mattn/emmet-vim',          { 'for': ['eruby','html'] }
  Plug 'sheerun/vim-polyglot'
  Plug 'xolox/vim-lua-ftplugin',   { 'for': 'lua' }

  " dependencies
  Plug 'xolox/vim-misc'
  Plug 'junegunn/vim-pseudocl'

  " misc
  Plug 'AndrewRadev/sideways.vim'
  Plug 'AndrewRadev/splitjoin.vim'
  Plug 'AndrewRadev/switch.vim'
  Plug 'christoomey/vim-tmux-navigator'
  Plug 'duff/vim-scratch'
  Plug 'dyng/ctrlsf.vim'
  Plug 'junegunn/vim-easy-align', { 'on': ['<Plug>(EasyAlign)', 'EasyAlign'] }
  Plug 'scrooloose/nerdtree'
  Plug 'sickill/vim-pasta'
  Plug 'terryma/vim-multiple-cursors'
  Plug 'tpope/vim-abolish'
  Plug 'tpope/vim-eunuch'
  Plug 'tpope/vim-projectionist'
  Plug 'tpope/vim-rsi'
  Plug 'vim-scripts/BufOnly.vim'
  " Plug 'airblade/vim-gitgutter'
  Plug 'tpope/vim-fugitive'

  if s:darwin
    Plug 'rizzatti/dash.vim',         { 'on': ['Dash', '<Plug>DashSearch', '<Plug>DashGlobalSearch'] }
    Plug 'zerowidth/vim-copy-as-rtf', { 'on': 'CopyRTF' }

    " completions are too much of a pain on linux
    source ~/.vim/scripts/completions.vim
  endif

  " custom vim objects
  Plug 'Julian/vim-textobj-brace'
  Plug 'beloglazov/vim-textobj-quotes'
  Plug 'coderifous/textobj-word-column.vim'
  Plug 'glts/vim-textobj-indblock'
  Plug 'kana/vim-textobj-entire'
  Plug 'kana/vim-textobj-fold'
  Plug 'kana/vim-textobj-indent'
  Plug 'kana/vim-textobj-user'
  Plug 'nelstrom/vim-textobj-rubyblock'

call plug#end()

set cmdheight=2          " hopefully prevents the 'hit enter' prompts
set foldlevelstart=20
set formatprg="par 79"   " respect the 80 character lines
set gdefault             " assume the /g flag on :s substitutions
set guicursor=a:blinkon0 " stop blinking
set hidden               " make unsaved buffers hidden
set hlsearch             " highlight searched phrases
set ignorecase
set modeline modelines=1 " check for syntax hints
set nojoinspaces         " use only 1 space after '.' when joining lines
set nowrap               " don't wrap
set noswapfile
set number
set shiftround           " indenting to nearest tabstop
set shortmess=WatAIT     " no interruptive prompts http://items.sjbach.com/319/configuring-vim-right
set showbreak=↪\         " show this character for breaks
set showmatch            " show matching brackets
set smartcase            " smartcase for searching
set splitbelow           " default split behavior
set splitright           " default split behavior
set virtualedit=onemore  " allow selection past last character

set ttimeoutlen=50       " vim-sensible's is kinda slow

set nocursorline
set nocursorcolumn
set scrolljump=5
set lazyredraw
set synmaxcol=180

set wildignore+=.DS_Store
set wildignore+=*.jpg,*.jpeg,*.gif,*.png,*.gif,*.psd,*.o,*.obj,*.min.js,*.sock
set wildignore+=*/bower_components/*,*/node_modules/*
set wildignore+=*/smarty/*,*/vendor/*,*/.git/*,*/.hg/*,*/.svn/*,*/.sass-cache/*,
set wildignore+=*/log/*,*/tmp/*,*/build/*,*/ckeditor/*,*/doc/*,*/source_maps/*,
set wildignore+=*/dist/*,.keep,.starscope.db,tags
set wildmode=list:longest

set softtabstop=2 tabstop=2 shiftwidth=2 expandtab

set fillchars=diff:⣿,vert:│

if s:darwin
  exe 'set t_kB=' . nr2char(27) . '[Z'
endif

if !has('gui_macvim')
  set t_Co=256
endif
colorscheme Tomorrow-Night-Eighties

set textwidth=80
if v:version > 703
  set colorcolumn=+1
endif
hi ColorColumn guibg=#000000 ctermbg=246

" Persistent Undo {{{
  silent !mkdir ~/.vim/backups > /dev/null 2>&1

  if has("persistent_undo")
    set undodir=~/.vim/backups
    set undofile
  endif
" }}}

source ~/.vim/scripts/autocommands.vim
source ~/.vim/scripts/mappings.vim
source ~/.vim/scripts/plugin_settings.vim
