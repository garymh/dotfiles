#!/bin/bash

function vpnon() {
  scutil --nc start "NU VPN" --user $NETID --password $NU_PASS --secret northwesternvpn
}

function vpnoff() {
  /usr/bin/env osascript <<-EOF
  tell application "System Events"
          tell current location of network preferences
                  set VPN to service "NU VPN"
                  if exists VPN then disconnect VPN
                  end tell
                end tell
  return
EOF
}

function vpn_status() {
  scutil --nc status "NU VPN" | grep -q Connected
}

if vpn_status; then
  vpnoff
  echo "Turning VPN off"
else
  vpnon
  echo "Turning VPN on"
fi
