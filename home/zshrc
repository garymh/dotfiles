DISABLE_AUTO_UPDATE="true"
source $DOTFILES/submodules/zgen/zgen.zsh

if ! zgen saved; then
  zgen oh-my-zsh

  if [[ $IS_MAC -eq 1 ]]; then
    zgen oh-my-zsh plugins/brew
    zgen oh-my-zsh plugins/brew-cask
    zgen oh-my-zsh plugins/osx
    zgen oh-my-zsh plugins/vagrant
    zgen oh-my-zsh plugins/heroku
  fi

  zgen oh-my-zsh plugins/bundler
  zgen oh-my-zsh plugins/capistrano
  zgen oh-my-zsh plugins/fasd
  zgen oh-my-zsh plugins/gem
  zgen oh-my-zsh plugins/github
  zgen oh-my-zsh plugins/rake
  zgen oh-my-zsh plugins/rake-fast
  zgen oh-my-zsh plugins/rbenv
  zgen oh-my-zsh plugins/zsh_reload

  # zgen oh-my-zsh plugins/rails
  # zgen doesn't seem to like the rails plugin

  # zgen load Treri/fzf-zsh
  zgen load Tarrasch/zsh-colors
  # zgen load djui/alias-tips
  # zgen load zsh-users/zsh-completions src
  # zgen load zsh-users/zsh-history-substring-search
  # zgen load zsh-users/zsh-syntax-highlighting

  zgen load garymh/dotfiles home/zsh/themes/gary_pure_mod
  # source ~/.zsh/themes/gary_pure_mod.zsh-theme

  zgen save
fi

for f ($HOME/.zsh/*.zsh) {source $f}

if [ 0 -ne $(ls $HOME/.zsh/private/*.zsh 2>/dev/null | wc -w) ]; then
  for f ($HOME/.zsh/private/*.zsh) {source $f}
fi

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
test -e ${HOME}/.iterm2_shell_integration.zsh && source ${HOME}/.iterm2_shell_integration.zsh

if [[ $HAS_IMG2XTERM -eq 1 ]]; then
  img2xterm $HOME/.zsh/plugins/meeseeks_iterm.png;
  green "-------------------------------"
  echo "$(uptime | awk -F'[a-z]:' '{ print "Load:"$2 }') | $(battery)"
elif [[ $HAS_COWSAY -eq 1 ]]; then
  echo "CAN DO!" | cowsay -f $HOME/.zsh/plugins/cows/meeseeks.cow
else
  uptime
fi
